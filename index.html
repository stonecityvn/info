<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ESP8266 Remote Panel (Static + mDNS)</title>
<style>
body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px}
.card{border:1px solid #ddd;border-radius:14px;padding:16px;margin:12px 0}
input,button{font-size:16px;padding:8px}
small{color:#666}
</style>
<h2>ESP8266 Remote Panel (Static + mDNS)</h2>

<div class="card">
  <h3>Không cần IP — dùng mDNS</h3>
  <p>Trang này sẽ gọi <code>http://esp8266.local</code>. Hãy chắc chắn ESP đã kết nối cùng mạng LAN, và mDNS hoạt động trên thiết bị của bạn.</p>
  <ul>
    <li>Windows: cài <b>Bonjour</b> (kèm iTunes) hoặc đảm bảo dịch vụ mDNS đang chạy.</li>
    <li>macOS / iOS: hỗ trợ sẵn.</li>
    <li>Android: thường hoạt động trong Chrome mới; nếu không, bạn có thể dùng trình duyệt khác hỗ trợ .local.</li>
  </ul>
</div>

<div class="card">
  <h3>Gửi tin nhắn</h3>
  <input id="msg" placeholder="Nội dung..." style="width:260px" />
  <button onclick="sendMsg()">Gửi</button>
  <p id="out"></p>
</div>

<div class="card">
  <h3>Đồng bộ thời gian</h3>
  <button onclick="syncTime()">Sync giờ sang ESP</button>
</div>

<script>
const BASE = 'http://esp8266.local';

async function sendMsg(){
  try{
    const url = BASE + '/push?text='+encodeURIComponent(document.getElementById('msg').value);
    const r = await fetch(url, {method:'GET', mode:'cors'});
    document.getElementById('out').textContent = await r.text();
  }catch(e){ alert('Không gửi được: '+e); }
}
async function syncTime(){
  try{
    const url = BASE + '/time?ts=' + Math.floor(Date.now()/1000);
    const r = await fetch(url, {method:'GET', mode:'cors'});
    alert(await r.text());
  }catch(e){ alert('Lỗi: '+e); }
}
</script>
